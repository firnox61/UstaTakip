@using UstaTakipMvc.Web.Models.Customers
@model CustomerCreateDto

@{
    Layout = "~/Views/Shared/_Layout.App.cshtml";
    ViewData["Title"] = "Müşteri Ekle";
    ViewData["ActiveMenu"] = "Customers";
}

<div class="d-flex align-items-center mb-3">
    <h4 class="mb-0 me-auto"><i class="fa-solid fa-user-plus me-2"></i>Müşteri Ekle</h4>
    <a asp-action="Index" class="btn btn-outline-secondary">
        <i class="fa-solid fa-arrow-left"></i> Listeye Dön
    </a>
</div>

<div class="card shadow-sm">
    <div class="card-body">
        <form asp-action="Create" method="post" novalidate>
            @Html.AntiForgeryToken()
            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

            @await Html.PartialAsync("_CustomerForm", Model)

            <div class="d-flex gap-2 mt-3">
                <button type="submit" class="btn btn-primary">
                    <i class="fa-regular fa-floppy-disk me-1"></i> Kaydet
                </button>
                <a asp-action="Index" class="btn btn-outline-secondary">İptal</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const typeSwitch = document.getElementById("typeSwitch");
            const typeInput = document.getElementById("typeInput");
            const typeLabel = document.getElementById("typeLabel");

            const individualFields = document.getElementById("individualFields");
            const corporateFields = document.getElementById("corporateFields");

            function refreshVisibility() {
                const isCorporate = typeSwitch.checked;

                typeInput.value = isCorporate ? 2 : 1;
                typeLabel.textContent = isCorporate ? "Tüzel" : "Bireysel";

                individualFields.style.display = isCorporate ? "none" : "";
                corporateFields.style.display = isCorporate ? "" : "none";
            }

            typeSwitch.addEventListener("change", refreshVisibility);
            refreshVisibility();
        });
    </script>
}
