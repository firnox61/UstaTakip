@{
    Layout = null;
    var title = ViewData["Title"] as string ?? "UstaTakip";
}
<!DOCTYPE html>
<html lang="tr" data-theme="light">
<head>
    <meta charset="utf-8" />
    <title>@title - UstaTakip</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/app-shell.css" />
</head>
<body>

    <!-- NAVBAR -->
    @await Html.PartialAsync("_Navbar")

    <div class="app-wrap d-flex">

        <!-- OVERLAY (sadece mobilde aktif) -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- SIDEBAR -->
        @await Html.PartialAsync("_Sidebar")

        <!-- MAIN CONTENT -->
        <main class="app-main flex-fill">
            <div class="container-fluid py-3">
                @await Html.PartialAsync("_Alerts")
                @RenderBody()
            </div>
        </main>

    </div>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const toggleButton = document.getElementById("sidebarToggle");
            const sidebar = document.querySelector(".app-sidebar");
            const overlay = document.getElementById("sidebarOverlay");

            toggleButton.addEventListener("click", function () {

                // 🖥 MASAÜSTÜ
                if (window.innerWidth >= 992) {
                    sidebar.classList.toggle("collapsed");

                    // Masaüstünde overlay ASLA kullanılmaz
                    overlay.classList.remove("active");
                }

                // 📱 MOBİL
                else {
                    sidebar.classList.toggle("mobile-open");

                    if (sidebar.classList.contains("mobile-open")) {
                        overlay.classList.add("active");
                    } else {
                        overlay.classList.remove("active");
                    }
                }
            });

            // 📱 Mobil overlay tıklaması → sidebar kapanır
            overlay.addEventListener("click", function () {

                // Sadece MOBILE'da sidebar kapanır
                if (window.innerWidth < 992) {
                    sidebar.classList.remove("mobile-open");
                }

                // Overlay kapanır
                overlay.classList.remove("active");

                // ❗ MASAÜSTÜDE sidebar’a ASLA collapsed ekleme!
                // (en büyük hatayı bu satır bozuyordu)
            });

        });
    </script>


    <!-- Tooltip -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
            tooltipTriggerList.map(el => new bootstrap.Tooltip(el));
        });
    </script>

    <!-- Dark Mode -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const root = document.documentElement;
            const toggleBtn = document.getElementById("themeToggle");
            const themeIcon = document.getElementById("themeIcon");

            let savedTheme = localStorage.getItem("theme") || "light";
            root.setAttribute("data-theme", savedTheme);
            updateIcon(savedTheme);

            toggleBtn.addEventListener("click", function () {
                let current = root.getAttribute("data-theme");
                let next = current === "light" ? "dark" : "light";
                root.setAttribute("data-theme", next);
                localStorage.setItem("theme", next);
                updateIcon(next);
            });

            function updateIcon(theme) {
                if (theme === "dark")
                    themeIcon.classList.replace("fa-moon", "fa-sun");
                else
                    themeIcon.classList.replace("fa-sun", "fa-moon");
            }
        });
    </script>

    @RenderSection("Scripts", required: false)

</body>
</html>
